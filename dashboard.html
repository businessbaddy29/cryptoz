<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Cryptoz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7f0;
            color: #2d5016;
            min-height: 100vh;
        }
        
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 260px;
            background-color: #2d5016;
            padding: 20px 0;
            transition: all 0.3s;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .logo {
            text-align: center;
            padding: 15px;
            border-bottom: 1px solid #3e6b1f;
            margin-bottom: 20px;
        }
        
        .logo h2 {
            color: #8bc34a;
            font-weight: 700;
        }
        
        .menu-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            color: #d7e0c9;
        }
        
        .menu-item:hover, .menu-item.active {
            background-color: #3e6b1f;
            border-left: 3px solid #8bc34a;
            color: #fff;
        }
        
        .menu-item i {
            margin-right: 12px;
            color: #8bc34a;
            width: 20px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
            background-color: #f5f7f0;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #d7e0c9;
        }
        
        .welcome-message h1 {
            font-size: 28px;
            color: #2d5016;
            margin-bottom: 5px;
        }
        
        .welcome-message p {
            color: #5a7a3e;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
        }
        
        .user-profile img {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            margin-right: 15px;
            border: 2px solid #8bc34a;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s;
            border-top: 3px solid #8bc34a;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .stat-card h3 {
            color: #5a7a3e;
            font-size: 16px;
            font-weight: 500;
        }
        
        .stat-card i {
            color: #8bc34a;
            font-size: 20px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2d5016;
            margin-bottom: 5px;
        }
        
        .stat-change {
            font-size: 14px;
            color: #8bc34a;
        }
        
        .content-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-header h2 {
            color: #2d5016;
            font-size: 20px;
            font-weight: 600;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #8bc34a;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #7cb342;
        }
        
        .btn-outline {
            background-color: transparent;
            color: #8bc34a;
            border: 1px solid #8bc34a;
        }
        
        .btn-outline:hover {
            background-color: rgba(139, 195, 74, 0.1);
        }
        
        .referral-link {
            background-color: #f0f7e6;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-left: 3px solid #8bc34a;
        }
        
        .referral-link input {
            background-color: transparent;
            border: none;
            color: #5a7a3e;
            flex: 1;
            padding: 5px;
            margin-right: 10px;
        }
        
        .referral-link button {
            background-color: #8bc34a;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .team-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .team-table th, .team-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #d7e0c9;
        }
        
        .team-table th {
            color: #5a7a3e;
            font-weight: 500;
            font-size: 14px;
        }
        
        .team-table tr:hover {
            background-color: #f0f7e6;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background-color: rgba(139, 195, 74, 0.1);
            color: #8bc34a;
        }
        
        .status-pending {
            background-color: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }
        
        .logout-btn {
            position: absolute;
            bottom: 20px;
            left: 25px;
            right: 25px;
            background-color: #c62828;
            color: white;
            padding: 12px;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background-color: #b71c1c;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #8bc34a;
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
            z-index: 1000;
            max-width: 300px;
            animation: slideIn 0.5s forwards;
        }
        
        .notification.error {
            background-color: #e53935;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .menu-item span {
                display: none;
            }
            
            .logo h2 {
                display: none;
            }
            
            .stats-container {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar">
            <div class="logo">
                <h2>Cryptoz</h2>
            </div>
            <div class="menu-item active" data-section="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" data-section="profile">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="menu-item" data-section="income">
                <i class="fas fa-dollar-sign"></i>
                <span>Income</span>
            </div>
            <div class="menu-item" data-section="team">
                <i class="fas fa-users"></i>
                <span>Team</span>
            </div>
            <div class="menu-item" data-section="deposit">
                <i class="fas fa-arrow-down"></i>
                <span>Deposit</span>
            </div>
            <div class="menu-item" data-section="withdrawal">
                <i class="fas fa-arrow-up"></i>
                <span>Withdrawal</span>
            </div>
            <div class="menu-item" data-section="history">
                <i class="fas fa-history"></i>
                <span>History</span>
            </div>
            <div class="menu-item" data-section="support">
                <i class="fas fa-headset"></i>
                <span>Support</span>
            </div>
            <div class="menu-item" data-section="referral">
                <i class="fas fa-link"></i>
                <span>Referral Link</span>
            </div>
            <div class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <div class="welcome-message">
                    <h1>Welcome back, <span id="userName">User</span>!</h1>
                    <p>Here's what's happening with your MLM business today.</p>
                </div>
                <div class="user-profile">
                    <img id="userProfileImage" src="https://randomuser.me/api/portraits/men/1.jpg" alt="Profile">
                    <div>
                        <div id="userFullName">John Doe</div>
                        <div style="font-size: 12px; color: #5a7a3e;">Premium Member</div>
                    </div>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <h3>Total Income</h3>
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-value" id="totalIncome">$0.00</div>
                    <div class="stat-change">+0% from last month</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-card-header">
                        <h3>Team Size</h3>
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="teamSize">0</div>
                    <div class="stat-change">+0 new members</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-card-header">
                        <h3>Direct Referrals</h3>
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div class="stat-value" id="directReferrals">0</div>
                    <div class="stat-change">+0 this week</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-card-header">
                        <h3>Current Balance</h3>
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div class="stat-value" id="currentBalance">$0.00</div>
                    <div class="stat-change">Available for withdrawal</div>
                </div>
            </div>
            
            <div class="content-section">
                <div class="section-header">
                    <h2>Referral Link</h2>
                    <button class="btn btn-primary" id="copyReferralBtn">Copy Link</button>
                </div>
                <div class="referral-link">
                    <input type="text" id="referralLink" readonly>
                    <button id="copyReferralLink">Copy</button>
                </div>
                <p style="color: #5a7a3e; font-size: 14px;">Share this link with your friends and earn commissions for each sign-up.</p>
            </div>
            
            <div class="content-section">
                <div class="section-header">
                    <h2>Recent Team Activity</h2>
                    <button class="btn btn-outline">View All</button>
                </div>
                <table class="team-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Join Date</th>
                            <th>Level</th>
                            <th>Status</th>
                            <th>Earnings</th>
                        </tr>
                    </thead>
                    <tbody id="teamTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #5a7a3e;">No team members found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDfXUvCI0U4NT2bf7tLh5CdtUxwn6xOWHc",
            authDomain: "cryptoz-3991c.firebaseapp.com",
            projectId: "cryptoz-3991c",
            storageBucket: "cryptoz-3991c.firebasestorage.app",
            messagingSenderId: "594456340792",
            appId: "1:594456340792:web:25d65fd0d3594f829879cd",
            measurementId: "G-XTG2RHTSQ6"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            auth.onAuthStateChanged(function(user) {
                if (!user) {
                    // User is not logged in, redirect to login page
                    window.location.href = 'login.html';
                    return;
                }
                
                // User is logged in, load user data
                loadUserData(user.uid);
                loadUserStats(user.uid);
                loadTeamMembers(user.uid);
            });
            
            // Menu item click handlers
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    menuItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // In a real application, this would load different content
                    const section = this.getAttribute('data-section');
                    console.log(`Navigating to ${section} section`);
                });
            });
            
            // Logout button handler
            document.getElementById('logoutBtn').addEventListener('click', function() {
                auth.signOut().then(() => {
                    showNotification('Logged out successfully!', 'success');
                    window.location.href = 'login.html';
                }).catch((error) => {
                    showNotification('Error logging out. Please try again.', 'error');
                });
            });
            
            // Copy referral link handlers
            document.getElementById('copyReferralBtn').addEventListener('click', copyReferralLink);
            document.getElementById('copyReferralLink').addEventListener('click', copyReferralLink);
            
            function copyReferralLink() {
                const referralLinkInput = document.getElementById('referralLink');
                referralLinkInput.select();
                document.execCommand('copy');
                
                showNotification('Referral link copied to clipboard!', 'success');
            }
            
            function showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = 'notification ' + type;
                notification.style.display = 'block';
                
                setTimeout(function() {
                    notification.style.display = 'none';
                }, 5000);
            }
            
            function loadUserData(uid) {
                database.ref('users/' + uid).once('value').then(function(snapshot) {
                    const userData = snapshot.val();
                    
                    if (userData) {
                        // Update user profile information
                        document.getElementById('userName').textContent = userData.fullName || 'User';
                        document.getElementById('userFullName').textContent = userData.fullName || 'John Doe';
                        
                        // Update referral link
                        const referralLink = `${window.location.origin}/register.html?ref=${userData.referralCode}`;
                        document.getElementById('referralLink').value = referralLink;
                    }
                }).catch((error) => {
                    console.error('Error loading user data:', error);
                });
            }
            
            function loadUserStats(uid) {
                // Load user statistics from Firebase
                // This is a simplified version - in a real app, you would calculate these values
                
                // Set default values
                document.getElementById('totalIncome').textContent = '$0.00';
                document.getElementById('teamSize').textContent = '0';
                document.getElementById('directReferrals').textContent = '0';
                document.getElementById('currentBalance').textContent = '$0.00';
                
                // In a real application, you would fetch and calculate these values from your database
                // For now, we'll just use placeholder values
            }
            
            function loadTeamMembers(uid) {
                const teamTableBody = document.getElementById('teamTableBody');
                teamTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #5a7a3e;">Loading team members...</td></tr>';
                
                // Load team members from Firebase
                database.ref('users/' + uid + '/team').once('value').then(function(snapshot) {
                    const teamMembers = snapshot.val();
                    
                    if (!teamMembers || Object.keys(teamMembers).length === 0) {
                        teamTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #5a7a3e;">No team members found</td></tr>';
                        return;
                    }
                    
                    teamTableBody.innerHTML = '';
                    
                    // Load each team member's data
                    Object.keys(teamMembers).forEach(function(memberId) {
                        database.ref('users/' + memberId).once('value').then(function(memberSnapshot) {
                            const memberData = memberSnapshot.val();
                            
                            if (memberData) {
                                const row = document.createElement('tr');
                                
                                // Name
                                const nameCell = document.createElement('td');
                                nameCell.textContent = memberData.fullName || 'Unknown';
                                row.appendChild(nameCell);
                                
                                // Join Date
                                const joinDateCell = document.createElement('td');
                                const joinDate = new Date(memberData.createdAt);
                                joinDateCell.textContent = joinDate.toLocaleDateString();
                                row.appendChild(joinDateCell);
                                
                                // Level (simplified - in a real app, you would calculate this)
                                const levelCell = document.createElement('td');
                                levelCell.textContent = 'Level 1';
                                row.appendChild(levelCell);
                                
                                // Status
                                const statusCell = document.createElement('td');
                                const statusBadge = document.createElement('span');
                                statusBadge.className = 'status-badge status-active';
                                statusBadge.textContent = 'Active';
                                statusCell.appendChild(statusBadge);
                                row.appendChild(statusCell);
                                
                                // Earnings (placeholder)
                                const earningsCell = document.createElement('td');
                                earningsCell.textContent = '$0.00';
                                row.appendChild(earningsCell);
                                
                                teamTableBody.appendChild(row);
                            }
                        }).catch((error) => {
                            console.error('Error loading team member data:', error);
                        });
                    });
                }).catch((error) => {
                    console.error('Error loading team members:', error);
                    teamTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #e53935;">Error loading team members</td></tr>';
                });
            }
        });
    </script>
</body>
</html>
